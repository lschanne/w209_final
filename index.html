<div class="page">
  <!-- Load libraries -->
<script src="https://d3js.org/d3.v6.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@5.1.0"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@6.17.0"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  
  <header id="header-background">
    <div class="logo"> </div>
    <h1>Brazilian Rainforest Deforestation</h1>
    <nav>
      <a href="#section-1">Introduction</a>
      <a href="#section-2">Deforestation by Year</a>
      <a href="#section-3">Deforestation Over Time</a>
      <a href="#section-4">Total Deforestation</a>
      <a href="#section-5">Comparison with Bodies of Land</a>
      <a href="#section-6">Impacts</a>
      <a href="#section-7">Factors and GHG Emissions</a>
      <a href="#section-8">Agriculture and Fires</a>
      <a href="#section-9">Soy Beans as an Export</a>
      <a href="#section-10">Explore Exports</a>
    </nav>
  </header>

  <main>

<!-- Section 1 Start -->
    <section id="section-1">
      <div>
      <h2> Introduction</h2>
          <p>
	Brazil hosts the largest Tropical Rain forest in the world with 30% of the <br>
	world tropical forests residing within it. The country with the second largest <br>
	portion, Congo, only has 8% of the world's tropical forest. The Amazon Rain Forest <br>
	is home to a diverse ecosystem which is important to local communities as well as <br>
	the wider ecosystems and climate around the world. While it is an integral part of <br>
	a global ecosystem, it is at risk of degradation due to deforestation over time.
        </p>

	
	<p>
	Satellite images of deforested area from July 4, 2000 to July 16, 2019 in Para, Brazil.<br>
	Credit: <a href="https://earthobservatory.nasa.gov/images/145888/making-sense-of-amazon-deforestation-patterns">Making Sense of Amazon Deforestation Patterns by Earth Observatory NASA</a></p>
      </div>  
	<img src="https://eoimages.gsfc.nasa.gov/images/imagerecords/145000/145888/br163defores_tmo_amo_2019.gif"
		width="520" 
		height="600" />
	

    </section>
<!-- Section 1 end -->


<!-- Section 2 Start -->
    <section id="section-2">
      <div>
      <h2> Deforestation by Year</h2>
        <p>
	The Brazil Amazon Rainforest has been experiencing deforestation since <br>
        the 1960s. It reached a peak high on 2004, and an effort to Reduce Emission <br>
        from Deforestation and Forest Degradation (REDD+) was proposed in 2005. 
        </p>
      </div>
	<div id="observablehq-brazilrf_def_chart-81cab98e"></div>
	<script type="module">
	import {Runtime, Inspector} from "https://cdn.jsdelivr.net/npm/@observablehq/runtime@4/dist/runtime.js";
	import define from "https://api.observablehq.com/d/bde65e52e9d64ac6.js?v=3";
	new Runtime().module(define, name => {
	  if (name === "brazilrf_def_chart") return new Inspector(document.querySelector("#observablehq-brazilrf_def_chart-81cab98e"));
	});
	</script>

    </section>
<!-- Section 2 end -->


<!-- Section 3 Start -->
     <section id="section-3">
 	<div>
		<label for="observablehq-viewof-year-6c041b8e" style="white-space: normal; font-size: small;">Press Play or Drag Slider<br></label>
		<div id="observablehq-viewof-year-6c041b8e"></div><br>
		<div id="observablehq-brazil_def_geo-6c041b8e"></div><br>
		<div id="observablehq-brazilrf_def_state-6c041b8e"></div><br>
	</div>
	<script type="module">
	import {Runtime, Inspector} from "https://cdn.jsdelivr.net/npm/@observablehq/runtime@4/dist/runtime.js";
	import define from "https://api.observablehq.com/d/bde65e52e9d64ac6.js?v=3";
	new Runtime().module(define, name => {
	  if (name === "viewof year") return new Inspector(document.querySelector("#observablehq-viewof-year-6c041b8e"));
	  if (name === "brazil_def_geo") return new Inspector(document.querySelector("#observablehq-brazil_def_geo-6c041b8e"));
	  if (name === "brazilrf_def_state") return new Inspector(document.querySelector("#observablehq-brazilrf_def_state-6c041b8e"));
	});
	</script>

       
      <div>
      <h2> Deforestation Over Time</h2>
	<p> 
	While REDD+ proved to help reduce deforestation in Brazil in the short term,<br>
	there has been an increase in deforested area starting 2013. From 2012 to 2020<br>
	deforested area has increased by 114%. Deforested area impact multi aspects of<br>
	Brazil's habitants as well as th rest of the world.
        </p>
        <p>
          For animals, the shelter and temperature regulation that the Rainforest provided <br>is lost. Local human communities that reside within the forest area experience a <br>
          short-lived boom which benefits them. However, once their natural resources <br>
          run out their level of development is almost identical prior to deforestation. <br>
          The deforestation also causes drier soil due to the tree that would
          help aid in <br>regulating regional and global water cycles being destroyed.
        </p> 

	<p>
	</p>
      </div>
    </section>
<!-- Section 3 End -->



<!-- Section 4 Start -->
    <section id="section-4">
      <div>
      <h2> Total Deforestation</h2>
          <p> Within the last 16 years, a total of 171,223 km² of the Brazillian Amazon<br>
	      Rainforest has been degraded due to deforestation. The total deforested <br>
	      area is similar in size to the following countries, Tunisia, Uruguay, Cambodia <br>
	      as well as the state of Florida. 
        </p>
      </div>

<iframe width="400" height="484" frameborder="0"
  src="https://observablehq.com/embed/bde65e52e9d64ac6?cells=bubble_chart"></iframe>

    </section>
<!-- Section 4 end -->

<!-- Section 5 Start -->
    <section id="section-5">
      <div>
        		<label for="observablehq-viewof-year-6c041b8e" style="white-space: normal; font-size: small;">Click and Drag Globe to Interact<br></label>
<div id="observablehq-globe-79e4f914"></div>

<script type="module">
import {Runtime, Inspector} from "https://cdn.jsdelivr.net/npm/@observablehq/runtime@4/dist/runtime.js";
import define from "https://api.observablehq.com/d/d57b8f13da8c6c3e.js?v=3";
new Runtime().module(define, name => {
  if (name === "globe") return new Inspector(document.querySelector("#observablehq-globe-79e4f914"));
});
</script>
        </div>
      
      
      <div>
      <h2> Comparison with Similar <br>Sized Bodies of Land</h2>
	<p>Total Deforesation (2004 - 2020): 171,223 km² <br>
	  Orange highlighted areas in the globe are areas of land that <br>
    are similar in size to the total deforested area between 2004 and 2020.<br>
	</p>

      </div>      

    </section>
<!-- Section 5 end -->

<!-- Section 6 Start -->
    <section id="section-6">
      <div>
      <h2> Impacts of Deforestation </h2>
	<p> 
	The packed bubble visual shows where Brazil’s contribution of the world<br>
	total CO<sub>2</sub> emission relative to the top contributing countries.<br>
	Even though Brazil is not a big industrial country compared with China, <br>
	Canada, and India yet it has a significant contribution of total CO<sub>2</sub><br>
	emission and <b>40%</b> of that contribution comes for rainforest deforestation. <br>
	Brazil represents <b>50%</b> of South America's total emissions. 
	</p>
	<p>
	Trees absorb carbon dioxide, mitigating greenhouse gas emissions produced by<br>
	human activity. As climate change continues, trees play an important role in <br>
	carbon sequestration.Tropical trees alone are estimated to provide about <b>23%</b><br>
	of the climate mitigation that's needed to offset climate change, according to<br>
	the World Resources Institute, a non-profit global research institute.
	</p>
     </div>
	
	<iframe width="40%" height="60%" frameborder="0"
	  src="https://observablehq.com/embed/bde65e52e9d64ac6?cells=emission_impact"></iframe>

    </section>
<!-- Section 6 end -->


<!-- Section 7 Start -->
    <section id="section-7">
      <div>
      <h2> Factors and Green House Gas Emission</h2>
	<p> The main causes that lead to deforestation in the Brazillian <br>
	Amazon Rainforest are stated as wood extraction, agricultural <br>
	and infrastructure expansion by 
	<a style="white-space:nowrap;" href="https://earthobservatory.nasa.gov/features/Deforestation/deforestation_update3.php">NASA</a>.
	</p>

	<p>
	Among the major causes, agriculture is the highest contributor. <br>
	Although in comparison with other factors, Land-Use stands <br>
	out, it is a good example of the REDD+ policy in action. After <br>
	its proposal, a drastic decline in Land-Use is showcased. When <br>
	included it within total GHG emission metric it seems as if <br>
	Brazil does not have an issue with GHG emissions. 
	</p>
	<p>
	However, when we exclude Land-Use, Agriculture can be addressed<br>
	as the highest contributer which has been steadily growing. <br>
	Agriculture's contribution also fits in line with the deforested<br>
	area's steady growth.
	</p>
      </div>
	<div id="observablehq-ghg_comp_chart-688aef9d"></div>

	
	<script type="module">
	import {Runtime, Inspector} from "https://cdn.jsdelivr.net/npm/@observablehq/runtime@4/dist/runtime.js";
	import define from "https://api.observablehq.com/d/bde65e52e9d64ac6.js?v=3";
	new Runtime().module(define, name => {
	  if (name === "ghg_comp_chart") return new Inspector(document.querySelector("#observablehq-ghg_comp_chart-688aef9d"));
	});
	</script>

    </section>
<!-- Section 7 end -->


<!-- Section 8 Start -->
    <section id="section-8">
      <div>
      <h2> Agriculture and Fires</h2>
	<p> 
	Agricutlure as a contributor is concerning due to a Slash-and-Burn method<br>
	used to clear land, plant crops and raise livestock. Major fires data <br>
	collected by the National Institute for Space Research 
	<a style="white-space:nowrap;" href="https://www.kaggle.com/mbogernetto/brazilian-amazon-rainforest-degradation?select=inpe_brazilian_amazon_fires_1999_2019.csv">(INPE)</a> can be <br>
	linked to deforested area over time.<br>
	</p>
     </div>

	<div id="observablehq-fire_def_chart-c0065e7a"></div>

	<script type="module">
	import {Runtime, Inspector} from "https://cdn.jsdelivr.net/npm/@observablehq/runtime@4/dist/runtime.js";
	import define from "https://api.observablehq.com/d/bde65e52e9d64ac6.js?v=3";
	new Runtime().module(define, name => {
	  if (name === "fire_def_chart") return new Inspector(document.querySelector("#observablehq-fire_def_chart-c0065e7a"));
	});
	</script>
	
    </section>
<!-- Section 8 end -->


<!-- Section 9 Start -->
    <section id="section-9">
	<div>
	<h2> Soy Beans as an Export </h2>
      	<p>Brazil is the world leading producer of Soybean with steady <br>
        production increase in the past few decades. The world's demand <br>
        for Soybean is increasing leading to increase in deforestation <br>
	rates due to dangerous farming methods, namely Slash-and-Burn.
        </p>
        </div>

	<iframe width="40%" height="60%" frameborder="0"
	  src="https://observablehq.com/embed/bde65e52e9d64ac6?cells=brazil_soy_plot"></iframe>

    </section>
<!-- Section 9 End -->  

<!-- Section 10 Start -->
<div id="section-10" style="padding-top: 124px;">
<div id="exports_header" style="width: 100%; height: 15%;">
    <h1> Brazil Exports</h1>
    <p>In this section, we would like to explore which products that are exported from Brazil may be associated with the deforestation of Brazilian rainforests. For this purpose, we are looking at the <a style="white-space:nowrap;" href="https://www.kaggle.com/mbogernetto/brazilian-amazon-rainforest-degradation?select=def_area_2004_2019.csv">deforestation rates from Kaggle</a> and the <a style="white-space:nowrap;" href="http://www.fao.org/faostat/en/#data/TP/metadata">export trade data from the Food and Agriculture Organization of the United Nations</a>. By comparing the trends in these data, we hope to provide guidance for experiments or regulations that are targeted at combatting the deforestation problem.</p>
    <p><span style="font-weight: bold;">Goal:</span> Allow use to explore which exports from Brazil may be key factors in deforestation.</p>
    <p><span style="font-weight: bold;">Takeaway:</span> Generally, export rates in Brazil are increasing at a rapid pace. Increasing production continues to jeopardize the rainforests.</p>
</div>
<div id="exports_details" style="width: 100%; height: 120vh; padding: 0; white-space: nowrap;">
    <div id="export_selection" style="width: 15%; height: 85vh; float: left; position: sticky; top: 15vh;">
        <p style="white-space: normal; font-size: small">To help you navigate the data, we have included a multi-select for filtering the data points by product. You can hold Ctrl (Cmd on Mac) and click to select multiple export products at once. Additionally, all three plots display tooltips when you hover the cursor over specific data points.</p>
        <label for="export_items">Choose export items:<br></label>
            <select name="export_items" id="export_items" multiple style="width: 100%; height: 75%; float: center;">
                <option value="animal fats and oils (excl. butter)">animal fats and oils (excl. butter)</option>
                <option value="apple">apple</option>
                <option value="avocados">avocados</option>
                <option value="bananas">bananas</option>
                <option value="barley">barley</option>
                <option value="beans, dry">beans, dry</option>
                <option value="beef">beef</option>
                <option value="beet pulp">beet pulp</option>
                <option value="bran, maize">bran, maize</option>
                <option value="brazil nuts, shelled">brazil nuts, shelled</option>
                <option value="buckwheat">buckwheat</option>
                <option value="cake, cottonseed">cake, cottonseed</option>
                <option value="carrots and turnips">carrots and turnips</option>
                <option value="cashew">cashew</option>
                <option value="cereal">cereal</option>
                <option value="cheese, processed">cheese, processed</option>
                <option value="chicken">chicken</option>
                <option value="chocolate products nes">chocolate products nes</option>
                <option value="cider etc">cider etc</option>
                <option value="cigarettes">cigarettes</option>
                <option value="citrus">citrus</option>
                <option value="cloves">cloves</option>
                <option value="cocoa">cocoa</option>
                <option value="coconut">coconut</option>
                <option value="coffee">coffee</option>
                <option value="cotton">cotton</option>
                <option value="cream fresh">cream fresh</option>
                <option value="crude materials nes">crude materials nes</option>
                <option value="dairy products">dairy products</option>
                <option value="egg">egg</option>
                <option value="fat nes, prepared">fat nes, prepared</option>
                <option value="fatty acids">fatty acids</option>
                <option value="fatty substance residues">fatty substance residues</option>
                <option value="feed, pulp of fruit">feed, pulp of fruit</option>
                <option value="fibre crops nes">fibre crops nes</option>
                <option value="fig">fig</option>
                <option value="flour">flour</option>
                <option value="fodder and feeding stuff">fodder and feeding stuff</option>
                <option value="food prep nes">food prep nes</option>
                <option value="food wastes">food wastes</option>
                <option value="fruit">fruit</option>
                <option value="ginger">ginger</option>
                <option value="glucose and dextrose">glucose and dextrose</option>
                <option value="grape">grape</option>
                <option value="groundnut">groundnut</option>
                <option value="hides and skins">hides and skins</option>
                <option value="honey, natural">honey, natural</option>
                <option value="infant food">infant food</option>
                <option value="juice, fruit nes">juice, fruit nes</option>
                <option value="lard">lard</option>
                <option value="lemon">lemon</option>
                <option value="macaroni">macaroni</option>
                <option value="maize">maize</option>
                <option value="malt">malt</option>
                <option value="mangoes, mangosteens, guavas">mangoes, mangosteens, guavas</option>
                <option value="margarine, short">margarine, short</option>
                <option value="mat">mat</option>
                <option value="meal, meat">meal, meat</option>
                <option value="meat, dried nes">meat, dried nes</option>
                <option value="meat, duck">meat, duck</option>
                <option value="meat, horse">meat, horse</option>
                <option value="meat, pork">meat, pork</option>
                <option value="meat, turkey">meat, turkey</option>
                <option value="melons, other (inc.cantaloupes)">melons, other (inc.cantaloupes)</option>
                <option value="milk">milk</option>
                <option value="mixes and doughs">mixes and doughs</option>
                <option value="molasses">molasses</option>
                <option value="oat">oat</option>
                <option value="offal">offal</option>
                <option value="oil, boiled etc">oil, boiled etc</option>
                <option value="oil, castor beans">oil, castor beans</option>
                <option value="oil, cottonseed">oil, cottonseed</option>
                <option value="oil, essential nes">oil, essential nes</option>
                <option value="oil, maize">oil, maize</option>
                <option value="oil, palm">oil, palm</option>
                <option value="oil, rapeseed">oil, rapeseed</option>
                <option value="oilseed">oilseed</option>
                <option value="onions, shallots, green">onions, shallots, green</option>
                <option value="orange">orange</option>
                <option value="other beverages">other beverages</option>
                <option value="other food">other food</option>
                <option value="other meat">other meat</option>
                <option value="other nuts">other nuts</option>
                <option value="other vegetables">other vegetables</option>
                <option value="papayas">papayas</option>
                <option value="pastry">pastry</option>
                <option value="pepper">pepper</option>
                <option value="pet food">pet food</option>
                <option value="pig">pig</option>
                <option value="pineapple">pineapple</option>
                <option value="potatoes">potatoes</option>
                <option value="pulses">pulses</option>
                <option value="pumpkins, squash and gourds">pumpkins, squash and gourds</option>
                <option value="rice">rice</option>
                <option value="root">root</option>
                <option value="rubber">rubber</option>
                <option value="sesame seed">sesame seed</option>
                <option value="sorghum">sorghum</option>
                <option value="soya sauce">soya sauce</option>
                <option value="soybean">soybean</option>
                <option value="spices nes">spices nes</option>
                <option value="starch, cassava">starch, cassava</option>
                <option value="straw husks">straw husks</option>
                <option value="sugar">sugar</option>
                <option value="sunflower">sunflower</option>
                <option value="sweet corn">sweet corn</option>
                <option value="sweet potatoes">sweet potatoes</option>
                <option value="tallow">tallow</option>
                <option value="tangerines, mandarins, clementines, satsumas">tangerines, mandarins, clementines, satsumas</option>
                <option value="tea">tea</option>
                <option value="textile fibres">textile fibres</option>
                <option value="tobacco">tobacco</option>
                <option value="tomato">tomato</option>
                <option value="wafers">wafers</option>
                <option value="watermelon">watermelon</option>
                <option value="waters,ice etc">waters,ice etc</option>
                <option value="wheat">wheat</option>
                <option value="wine">wine</option>
                <option value="wool">wool</option>
            </select><br>
            <button id="filter_exports_btn" onclick="set_selections()" style="margin-top: 5px;">Apply</button>
            <button id="select_all_btn" onclick="set_selections(true)" style="margin-left: 10%;">Select All</button>
    </div>
    <div id="plots_container" style="width: 75%; height: 100%; padding-left: 15%;">
            <div id="deforestation" style="width: 100%; height:33%;"></div><br>
            <div id="exports" style="width: 100%; height:33%;"></div><br>
            <div id="correlation" style="width: 100%; height:33%;"></div><br>
    </div>
</div>

<script>
    var corr_data,
        deforestation_data,
        export_data,
        max_year = 2019,
        min_year = 2004,
        years = [];
    
    let year = min_year;
    while (year <= max_year) {
        years.push(year);
        year = year + 1;
    }

    d3.csv("./data/processed/brazil_corr_data.csv").then(function(data) {
        corr_data = data;
        max_exported_tonnes = -Infinity;
        d3.csv("./data/processed/brazil_deforested_area.csv").then(function(data) {
            deforestation_data = data;
            plot_deforestation(deforestation_data);
            d3.csv("./data/processed/brazil_exports.csv").then(function(data) {
                export_data = data;
                set_selections(true);
            })
        })
    })

    function set_selections(select_all=false) {
        if (select_all) {
            $("#export_items > option").each(function () {
                $(this).prop("selected", true);
            })
            plot_correlations(corr_data);
            plot_exports(export_data);
        } else {
            var selection_map = {},
                selected_corr_data = [],
                selected_export_data = [];

            $("#export_items :selected").map(
                (_, e) => selection_map[e.value] = true
            );
            for (let iii in corr_data) {
                let d = corr_data[iii];
                if (selection_map[d.item]) {
                    selected_corr_data.push(d);
                }
            }
            for (let iii in export_data) {
                let d = export_data[iii];
                if (selection_map[d.item]) {
                    selected_export_data.push(d);
                }
            }
            plot_correlations(selected_corr_data);
            plot_exports(selected_export_data);
        }
    }

    function plot_correlations(data) {
        var selector = "#correlation",
            div = $(selector),
            spec = {
                $schema: "https://vega.github.io/schema/vega-lite/v5.json",
                description: "Correlation between deforestation and exportation",
                data: {values: data},
                mark: "point",
                encoding: {
                    x: {field: "total_tonnes_exported", type: "quantitative", title: "Total Tonnes Exported", scale: {type: "log", domain: [10000, 900000000]}},
                    y: {field: "corr", type: "quantitative", title: "Annual Corr: Tonnes Exported and DF Area (km^2)", scale: {domain: [-1, 1]}},
                    color: {field: "item", type: "nominal", title: "Item", legend: {columns: 2}},
                    tooltip: [
                        {field: "item", type: "nominal", title: "Item"},
                        {field: "total_tonnes_exported", type: "quantitative", title: "Total Tonnes Exported", format: ".3s"},
                        {field: "corr", type: "quantitative", title: "Correlation", format: ".3f"},
                        {field: "n", type: "quantitative", title: "Years Measured", format: ".0f"}
                    ]
                },
                title: "Correlation Between Tonnes Exported and Deforested Area (km^2) Annually v. Total Tonnes Exported by Product",
                width: div.width(),
                height: div.height(),
                autosize: {type: "fit", contains: "padding"}
            };
        vegaEmbed("#correlation", spec);
    }

    function plot_deforestation(data) {
        var selector = "#deforestation",
            div = $(selector),
            spec = {
                $schema: "https://vega.github.io/schema/vega-lite/v5.json",
                description: "Deforestation rates by year",
                data: {values: data},
                mark: {
                    type: "line",
                    point: true
                },
                encoding: {
                    x: {field: "year", type: "quantitative", title: "Year", scale: {domain: [min_year, max_year]}, axis: {values: years, format: "d"}},
                    y: {field: "deforested_area_km2", type: "quantitative", title: "Deforested Area (km^2)"},
                    tooltip: [
                        {field: "year", type: "ordinal", title: "Year"},
                        {field: "deforested_area_km2", type: "quantitative", title: "Deforested Area (km^2)", format: ".3s"}
                    ]
                },
                title: "Total Deforested Area per Year",
                width: div.width(),
                height: div.height(),
                autosize: {type: "fit", contains: "padding"}
            };
        vegaEmbed("#deforestation", spec);
    }

    function plot_exports(data) {
        console.log(data);
        var selector = "#exports",
            div = $(selector),
            spec = {
                $schema: "https://vega.github.io/schema/vega-lite/v5.json",
                description: "Tonnes exported by year and by item",
                data: {values: data},
                mark: {
                    type: "line",
                    point: true
                },
                encoding: {
                    x: {field: "year", type: "quantitative", title: "Year", scale: {domain: [min_year, max_year]}, axis: {values: years, format: "d"}},
                    y: {field: "tonnes_exported", type: "quantitative", title: "Tonnes Exported"},
                    color: {field: "item", type: "nominal", title: "Item", legend: {columns: 2}},
                    tooltip: [
                        {field: "item", type: "nominal", title: "Item"},
                        {field: "year", type: "ordinal", title: "Year"},
                        {field: "tonnes_exported", type: "quantitative", title: "Tonnes Exported", format: ".3s"}
                    ]
                },
                title: "Tonnes Exported Annually from Brazil by Product",
                width: div.width(),
                height: div.height(),
                autosize: {type: "fit", contains: "padding"}
            };
        vegaEmbed("#exports", spec);
    }
</script>
</div>
   
<!-- Section 10 End-->

 
  </main>
  <footer>
    <h1>About</h1>
  <p>Author: Kritesh Shrestha, Mohamed, Luke </p>
  <p><a href="mailto:hege@example.com">hege@example.com</a></p>
    <p>Text should include the names of team members, the visualization’s goals,<br> 
      its intended audience, and the data source(s). This may be included as an <br>
      About page or integrated with the visualization itself, as appropriate.</p>
</footer>
  
  
</div>